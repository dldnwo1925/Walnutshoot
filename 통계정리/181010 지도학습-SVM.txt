# SVM (Support Vector Machine)
- 서로 다른 분류에 속한 데이터 간 간격이 최대가 되는 선을 찾아 이를 기준으로 데이터를 분류하는 알고리즘
- 데이터 간 간격이 최대가 되는 선을 찾아 추후 새로운 데이터에 대한 오류율을 줄여주는 것(커널 트릭)
- 하나의 직선을 사용하여 나눌 수 없을 때는 주어진 데이터를 고차원 특징 공간으로 변경해준다.
  고차원 공간에서는 원래 보이지 않던 선형으로 분류해줌 ex)원형, 타원형 등  

- 가우시안 RBF 커널이 좋은 모델.
- Cost : 얼마나 많은 데이터 샘플이 다른 클래스에 놓이는 것을 허용하는지 결정, 낮을수록 많이 높을수록 적게
- Cost가 높으면 완벽하게 분류하길 원하는 모델
- Gamma : 하나의 데이터 샘플이 영향력을 행사하는 거리 > 가우시안 함수 표준편차와 관련 > 클수록 작은 표준편차임.
- Gamma가 클수록 데이터 포인터들이 영향력을 행사하는 거리가 길어지고 낮을수록 짧아진다.
- 정리 : Cost는 데이터 샘플들이 다른 클래스에 놓이는 것을 허용하는 정도, Gamma는 결정 경계의 곡률을 결정.


# SVM 모델
- 두 집단에서 가장 가까운 점들 사이에 있는 최대 거리의 선 또는 편명을 최대 여백 초평면(Maximum Margin Hyperplane)
  이라고 하고 가장 가까운 점들을 서포트 벡터라고 부름.
- 최대 여백 초평면은 분류를 나누는 기준이 된다.
- 모든 데이터를 항상 초평면으로 나눌수 있는 것은 아니다. 곡선이 필요한 데이터 집합이 있을 수 있기 때문이다.
- 이 문제를 커널 트릭으로 해결할 수 있음.

※ 커널 트릭
- 주어진 데이터를 적절한 고차원으로 옮긴 뒤 변환된 차원에서 SVM을 사용해 초평면을 찾는 것이다.
- SVM모델의 핵심 수식은 벡터 간 내적 계산으로 이루어진다.
- 커널 트릭에서는 실제 데이터를 고차원으로 변환하는 대신 고차원에서 벡터 간 내적 계산을 했을 떄와 같은 값을 반환
  하는 함수를 사용한다. 이 함수들로 데이터들을 고차원으로 옮긴 듯한 효과를 일으키며 비용을 절감할 수 있다.
  이러한 함수들을 커널 함수(Kernel Function)라고 한다.
- 다항 커널 : 입력의 모든 차원의 조합인 공간에서 내적 게산을 한 것과 같은 결과를 반환함.
- 가우시안 커널 : 무한 차원으로 데이터를 옮긴 뒤 그곳에서 내적 계산을 한 것과 같은 결과를 반환함.

# SVM 학습
- R 패키지 - e1071 > libsvm을 R에서 사용할 수 있도록 만든 패키지
		   kernlab > 커널 기반의 머신러닝 알고리즘을 R에서 구현한 것.
※ R파일로 따로 정리

- SVM은 커널을 사용하여 특정한 방식으로 변수공간을 확장한 결과이다.
- 커널 : 클래스들 사이의 비선형 경계를 수용하기 위해 변수공간을 확장하고자 할 때 사용하는 계산기법.
- 커널의 차원을 높임으로써 좀 더 다양한 결정경계가 만들어지고 이를 다항식 커널이라 한다.
- 즉, 변수공간에서가 아니라 차수가 d인 다항식들이 관련되는 더 높은 차원의 공간에서 서포트 벡터 분류기를 적합하는 것
  그리고 Support Vector Classifier가 비선형 커널과 결합될 때 얻어지는 분류기를 SVM이라고 한다.
- 비선형커널 외에도 방사커널(Radial Kernel == 가우시안터널)이 널리 사용됨.

※ SVM 파라미터 튜닝
- 위에서 언급한 Cost, Gamma값 설정이다.
- Cost는 SVM모델에 얼만큼 오차를 허용할 것인지에 대한 파라미터값.
- Cost가 크면 Margin폭이 좁아지고, Cost가 작으면 Margin은 넓어진다.

- Gamma는 SVM에서 초평면이 아닌 커널과 관련이 있는 수치. SVM함수에서 Gamma는 가우시안 표준편차를 조정하는 인자
  큰 값을 가질수록 작은 표준편차를 가짐.
- R에서 svm함수의 radial이 설정될 때 Gamma값 조정. 일반 초평면은 kernel인자가 linear입력, cost만 조정해주면 됨.

# Support Vector Classifier
- SVM의 1차 항과 같은 의미.
- SVM함수에 kernel인자에 linear을 입력하면 SVC가 수행되고 이 때 cost값으로 소프트마진을 결정하는 것.
- 반대로 SVM을 수행하려면 kernel인자에 polynomial을 입력하고 degree로 차수를 지정해주어야함.
- degree가 1을 초과하게 되면 SVC가 아닌 SVM이 되는 것이다 그리고 cost값을 조절해주면 된다.
- 마지막으로 kernel인자에 radial을 입력하면 방사커널이 수행, 이 때는 Gamma와 Cost값을 조절해야함.


※ R에서 SVM수행시 고려사항
- 함수 자체에 변수 scale(표준화)를 해주기 때문에 scale이 필요 없음.
  표준화가 필요 없을 때는 scale 옵션을 False로
- kernel의 기본값은 방사(radial)이므로 cost, gamma값 조정해주어야함.
- 초평면을 원한다면 kernel인자를 "linear"을 입력하면 된다. 이 때는 cost값만 조정하면 된다.
- 다항 커널을 원한다면 kernel인자에 ploynomial을 지정하고 degree인자로 차수를 지정한다.
- 데이터 분포를 plot으로 나타냄으로써 선형 초평면, SVM에서 다항식 커널, 방사 커널 중 무엇을 이용하는지 결정해야 함.
- SVM의 목적은 초평면을 기준으로 한쪽 면으로 동일한 데이터가 놓이게 평평한 경계를 만드는 것.



