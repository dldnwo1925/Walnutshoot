# 신경망(Neural Network)
- 인간의 뇌를 본 떠 만든 알고리즘.
- 뉴런을 흉내 낸 노드들이 입력층(Input Layer), 은닉층(Hidden Layer), 출력층(Output Layer)로 구분되어 있음.
- 입력층에 주어진 값은 입력층 -> 은닉층 -> 출력충 순서로 전달된다.
- 은닉층에서 입력 값이 조합되므로 비선형적인 문제를 해결할 수 있는 특징이 있음.
- 의사 결정 나무 모델과 같은 직관적인 모델과 달리 난이도가 어려운편이고 수작업으로 모델 수정하기도 어렵다.

# 전달 순서
데이터 입력 -> 은닉층 활성화, 출력 값 계산 -> 출력층 왈성화 최종 출력 값 계산(모델의 최종 예측 결과)

※ 입력층, 은닉층, 출력층의 노드와 원리 설명
- 각 노드에서 이동하는 방향에는 가중치가 부여된다.
- 입력층의 노드 i와 은닉층 노드 j를 연결한 방향에 부여된 가중치를 wij라 가정, 입력층에 오는 입력을
  x1,x2,xi... xn이라 가정했을때 입력층에 주어진 값들은 은닉층 노드 j로 모인다.
- 은닉층 노드인 j로 전달되는 이 값을 넷 활성화(net activation)라고 하며 이와 같은 계산식을 합성 함수라고 한다.
- j가 출력층에 보내는 값은 넷 활성화 값을 활성 함수(activation function)에 통과시킨 결과이다.
- 활성 함수 중 많이 사용되는 두 가지는 sign에 따라 다른 결과를 출력하는 함수, 시그모이드 함수가 있다.

# 신경망 학습
- 가중치 w의 조절 작업이라고 볼 수 있음.
- 입력 값 X와 출력값 Y가 있을 때 입력층에 입력 후 모델의 출력 값이 원하는 출력 값과 같은지 비교, 다르다면 가중치를 조절한다.
- 모델의 출력 값이 원하는 값인지 비교할 때 기준은 에러의 제곱 합(SSE)와 정보 이론의 엔트로피가 있다.
- 역전파 알고리즘을 통해 신경망 모델이 널리 사용되게 되었음.
※ 역전파 알고리즘 ?
- 출력 값에서 예상 값과 차이가 발견되면 차이가 발생한 출력 노드로부터 연결된 은닉노드, 입력 노드로 거슬러 올라가며
  가중치를 조절하여 식이 0에 가까워지게 함. 이를 반복하다보면 적절한 가중치가 발견됨.
※ 과적합 방지
- 주어진 데이터에 딱 맞게 가중치를 조절하다보면 과적합이 발생할 수 있다.
- 과적합을 피하는 한 가지 방법중 역전파 알고리즘에 따라 가중치를 교정할 때마다 0과 1사이의 값을 가지는 ε을
  가중치에 곱해주는 방법이있다. 이를 가중치 감소(weight decay)라고 함.
- 가중치 감소 식 : w = w*(1-ε)

# 신경망 출력
- 신경망의 출력으로 확률을 원할 경우 최솟값이 0, 최댓값이 1이 되도록 해주는 소프트맥스 함수를 사용함.

# R 신경망 패키지
- nnet패키지 : 신경망 모델 작성
- 신경망의 파라미터는 엔트로피 또는 SSE를 고려해 최적화 됨.
- 출력 결과는 소프트맥스를 사용해 확률과 같은 형태로 변환 가능함.
- 과적합을 막기 위한 방법으로 가중치 감소를 제공함.

※ 포뮬러를 사용한 모델
- 신경망을 잘 사용하려면 데이터에 정규화를 적용한 뒤 신경망 모델을 만들어야 함. 의무는 아니지만 적용하는 것이 좋음.
- 신경망은 가중치를 임의의 값으로 초기화한 후 반복적으로 가중치를 조절하며 SSE 또는 엔트로피 기준을 최적화 함.
- 반복적으로 답을 찾아가는 이유는 수식으로 단번에 최적의 가중치를 찾기는 힘들기 떄문이다.
- 1. linout옵션의 기본값이 FALSE이므로 출력층에서 선형 함수가 아닌 시그모이드 함수가 사용된다.
- 2. 예측 대상이 되는 분류(Y의 레이블 값)의 수가 2개라면 엔트로피를 사용해 ㅐ파라미터가 추정됨.
	 분류의 수가 3개 이상이라면 SSE로 파라미터가 추정, 소프트맥스가 적용된다.

※ X, Y 데이터 직접 지정
- 좀 더 빠른 속도를 원하거나 각종 파라미터가 nnet()에서 자동으로 지정되는 것을 원치 않는 경우 직접 지정할 수 있음.
- 이를 위해 가장 먼저 해야 할 일은 Y를 지시행렬로 변환하는 것이다.
- 지시 행렬 만드는 함수 nnet::class.ind
- 반환 값은 각 행에 관측값을 놓고 각 열에 분류를 놓은 다음 해당 분류에 속할 경우 1을 아니라면 0을 저장한 행렬.
※ 용어 설명
- 입력값(Input Layer) : 초기 변수
- 결과값(Output) : 결과 값이 0, 1 중 하나로 나올 경우 Classification, 그 외의 경우 Regression 문제로 정의
				 사용되는 기술들이 다름.
- 편차(Bias) : 각 Layer에서 처리하지 못하는 오차값
- 가중치(Weight) : 입력값이 뉴런에게 주는 가중치
- 은닉층(Hidden Layer) : 변수들을 처리하는 가상의 계산 단계, 층위의 숫자가 많을수록 모델의 정확도와 비용 향상.



